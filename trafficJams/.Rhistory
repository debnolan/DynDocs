})
cutoff <- quantile(dmin, 0.9999, na.rm = TRUE)
k <- nint/100
res <- apply(d, 1, Categorize)
res[ocnorm < 0.5 | spnorm > 0]  <- FALSE
res[ocnorm > 1 & spnorm < -1] <- TRUE
cong <- as.data.frame(matrix(res, ncol = 3))
par(mfrow = c(1, 1))
plot(speed3, traf$Occ3, cex = 0.6, xlim = spRange, ylim = ocRange,
col = cols[3, ][cong[, 3] + 1], xlab = "speed", ylab = "Occupancy",
main = "Occupancy vs Speed", xaxt = "n")
points(speed2, traf$Occ2, cex = 0.6, xlim = spRange, ylim = ocRange,
col = cols[2, ][cong[, 2] + 1])
points(speed1,   traf$Occ1, cex = 0.6, xlim = spRange, ylim = ocRange,
col = cols[1, ][cong[, 1] + 1])
legend("topright", col = t(cols), bty = "n", pch = 16,
legend = c("left non-congestion", "left congestion",
"middle non-congestion", "middle congestion",
"right non-congestion", "right congestion"))
png("speedHist.png", res = 220)
par(mfrow = c(2, 2))
hist(speed1, breaks = 50, xlim = spRange, xlab = "", col = "lightyellow",
main = "Histogram of V, left lane")
hist(speed2, breaks = 50, xlim = spRange, xlab = "", col = "lightyellow",
main = "Histogram of V, middle lane")
hist(speed3, breaks = 50, xlim = spRange, xlab = "", col = "lightyellow",
main = "Histogram of V, right lane")
boxplot(speed1, speed2, speed3, col = cols[, 2], yaxt = "n",
main = "Boxplots of speed in three lanes")
axis(1, at = 1:3, labels = c("left", "middle", "right"))
dev.off()
png("speedHist.png", res = 220)
par(mfrow = c(2, 2))
hist(speed1, breaks = 50, xlim = spRange, xlab = "", col = "lightyellow",
main = "Histogram of V, left lane")
hist(speed2, breaks = 50, xlim = spRange, xlab = "", col = "lightyellow",
main = "Histogram of V, middle lane")
hist(speed3, breaks = 50, xlim = spRange, xlab = "", col = "lightyellow",
main = "Histogram of V, right lane")
boxplot(speed1, speed2, speed3, col = cols[, 2], yaxt = "n",
main = "Boxplots of speed in three lanes")
axis(1, at = 1:3, labels = c("left", "middle", "right"))
dev.off()
Categorize <- function(x) {
sum(x[!is.na(x)] < cutoff) <= k
}
flow  <- unlist(traf[, c(2, 4, 6)])
occ   <- unlist(traf[, c(1, 3, 5)])
speed <- c(speed1, speed2, speed3)
flnorm <- (flow  - mean(flow))/sd(flow)
ocnorm <- (occ   - mean(occ))/sd(occ)
spnorm <- (speed - mean(speed, na.rm = TRUE))/sd(speed, na.rm = TRUE)
names(flnorm) <- names(ocnorm) <- names(spnorm) <- as.character(1:nint)
d <- as.matrix(dist(data.frame(spnorm, ocnorm)))
diag(d) <- NA
d[is.na(speed), ] <- d[, is.na(speed)] <- NA
dmin <- apply(d, 1, function(x) {
if (all(is.na(x))) return(NA)
min(x[x != 0], na.rm = TRUE)
})
cutoff <- quantile(dmin, 0.9999, na.rm = TRUE)
k <- nint/100
res <- apply(d, 1, Categorize)
res[ocnorm < 0.5 | spnorm > 0]  <- FALSE
res[ocnorm > 1 & spnorm < -1] <- TRUE
cong <- as.data.frame(matrix(res, ncol = 3))
par(mfrow = c(1, 1))
plot(speed3, traf$Occ3, cex = 0.6, xlim = spRange, ylim = ocRange,
col = cols[3, ][cong[, 3] + 1], xlab = "speed", ylab = "Occupancy",
main = "Occupancy vs Speed", xaxt = "n")
points(speed2, traf$Occ2, cex = 0.6, xlim = spRange, ylim = ocRange,
col = cols[2, ][cong[, 2] + 1])
points(speed1,   traf$Occ1, cex = 0.6, xlim = spRange, ylim = ocRange,
col = cols[1, ][cong[, 1] + 1])
legend("topright", col = t(cols), bty = "n", pch = 16,
legend = c("left non-congestion", "left congestion",
"middle non-congestion", "middle congestion",
"right non-congestion", "right congestion"))
par(mfrow = c(2, 2))
hist(speed1, breaks = 50, xlim = spRange, xlab = "", col = "lightyellow",
main = "Histogram of V, left lane")
hist(speed2, breaks = 50, xlim = spRange, xlab = "", col = "lightyellow",
main = "Histogram of V, middle lane")
hist(speed3, breaks = 50, xlim = spRange, xlab = "", col = "lightyellow",
main = "Histogram of V, right lane")
boxplot(speed1, speed2, speed3, col = cols[, 2], yaxt = "n",
main = "Boxplots of speed in three lanes")
axis(1, at = 1:3, labels = c("left", "middle", "right"))
getwd()
uiOutput("plotui")
library(shiny)
uiOutput("plotui")
?brushOpts
?plotOutput
?renderUI
fluidRow(
column(width = 4, class = "well",
h4("Brush and double-click to zoom"),
plotOutput("plot1", height = 300,
dblclick = "plot1_dblclick",
brush = brushOpts(
id = "plot1_brush",
resetOnNew = TRUE
)
edgeR
??edgeR
library(shiny)
?brushOpts
shiny::runApp('Documents/Projects/DynDocs/templates/shinyExPlotClick1')
?nearPoints
shiny::runApp('Documents/Projects/DynDocs/templates/shinyExPlotClick1')
head(mtcars)
head(mtcars[c("wt", "mpg")])
shiny::runApp('Documents/Projects/DynDocs/templates/shinyExPlotClick1')
fluidPage(
fluidRow(
column(width = 6,
plotOutput("plot1", height = 350,
click = "plot1_click",
brush = brushOpts(
id = "plot1_brush"
)
),
actionButton("exclude_toggle", "Toggle points"),
actionButton("exclude_reset", "Reset")
)
shiny::runApp('Documents/Projects/DynDocs/templates/shinyExPlotClick1')
nearPoints
shiny::runApp('Documents/Projects/DynDocs/templates/shinyExPlotClick1')
nearPoints
scaleCoord
scaleCoords
?scaleCoords
require(shiny)
scaleCoords
panelMatch
?do.call
?apply
shiny::runApp('Documents/Projects/DynDocs/templates/shinyExPlotClick1')
sapply(mtcars, class)
shiny::runApp('Documents/Projects/DynDocs/templates/shinyExPlotClick1')
nearPointIndex <- function(data, point, threshold = 0.1) {
# data: matrix with 2 cols or a data frame
# point: coordinates of a point
# threshold: proportion of the range to be included
rangeX <- point[1] + c(-1, 1)*diff(range(data[, 1]))*threshold
rangeY <- point[2] + c(-1, 1)*diff(range(data[, 2]))*threshold
close <- which(rangeX[1] < data[, 1] & data[, 1] < rangeX[2] &
rangeY[1] < data[, 2] & data[, 2] < rangeY[2])
distclose <- sqrt((data[close, 1] - point[1])^2 + (data[close, 2] - point[2])^2)
return(close[which.min(distclose)])
}
vals$clicks <- c(4, 15)
vals <- list
vals$clicks <- c(4, 15)
vals <- list()
vals$clicks <- c(4, 15)
nearInd <- nearPointIndex(mtcars[c("wt", "mpg")], vals$clicks)
nearInd
shiny::runApp('Documents/Projects/DynDocs/templates/shinyExPlotClick1')
nearPointIndex <- function(data, point, threshold = 0.1) {
# data: matrix with 2 cols or a data frame
# point: coordinates of a point
# threshold: proportion of the range to be included
point <- as.numeric(point)
rangeX <- point[1] + c(-1, 1)*diff(range(data[, 1]))*threshold
rangeY <- point[2] + c(-1, 1)*diff(range(data[, 2]))*threshold
close <- which(rangeX[1] < data[, 1] & data[, 1] < rangeX[2] &
rangeY[1] < data[, 2] & data[, 2] < rangeY[2])
distclose <- sqrt((data[close, 1] - point[1])^2 + (data[close, 2] - point[2])^2)
return(close[which.min(distclose)])
}
shiny::runApp('Documents/Projects/DynDocs/templates/shinyExPlotClick1')
shiny::runApp('Documents/Projects/DynDocs/trafficJams/traffic')
?symbols
shiny::runApp('Documents/Projects/DynDocs/trafficJams/traffic')
setwd("~/Documents/Projects/DynDocs/trafficJams")#
#
traf <- read.csv("http://www.stat.berkeley.edu/~rice/UCLA/flow-occ-table.txt")#
traf2 <- read.csv("http://www.stat.berkeley.edu/users/nolan/stat133/data/flow-occ-table.txt")#
> identical(traf, traf2)#
[1] TRUE#
#
nearPointIndex <- function(data, point, threshold = 0.1) {#
	# finds the index (of a data row) of a nearest point#
	# data: matrix with 2 cols or a data frame#
	# point: coordinates of a point #
	# threshold: proportion of the range to be included#
	scaled <- scale(rbind(point, data))#
	data   <- scaled[-1, ]#
	point  <- scaled[1, ]#
	rangeX <- point[1] + c(-1, 1)*diff(range(data[, 1]))*threshold#
	rangeY <- point[2] + c(-1, 1)*diff(range(data[, 2]))*threshold#
	close <- which(rangeX[1] < data[, 1] & data[, 1] < rangeX[2] &#
	               rangeY[1] < data[, 2] & data[, 2] < rangeY[2])#
    distclose <- sqrt((data[close, 1] - point[1])^2 + (data[close, 2] - point[2])^2)               #
    return(close[which.min(distclose)])#
}#
#
PointsToLine <- function(x, y) {#
  # x, y: coordinates of two points (vectors of length 2)#
  slope <- (y[2] - y[1])/(x[2] - x[1])#
  icept <- y[1] - x[1]*slope#
  return(c(icept = icept, slope = slope))#
}
library(shiny)#
#
#traf <- read.csv("http://www.stat.berkeley.edu/~rice/UCLA/flow-occ-table.txt")#
traf <- read.csv("flow-occ-table.txt")#
nint <- nrow(traf) # number of 5-min intervals, 1740#
#
### Suppose starts on March 14th, 2003, Friday at midnight (we don't know the time)#
### then ends at 1am on Thur, March 20th#
day <- rep(c("Fri", "Sat", "Sun", "Mon", "Tue", "Wed", "Thur"), #
                each = 24*12, length.out = nint)#
time <- paste(rep(0:23, each = 12, length.out = nint), #
                   rep(c("00", "05", seq(10, 55, by = 5)), length.out =    nint), #
              sep = ":") #
#
# reshape data#
traf <- data.frame(Occ  = with(traf, c(Occ1, Occ2, Occ3)),#
                   Flow = with(traf, c(Flow1, Flow2, Flow3)),#
                   lane = rep(1:3, each = nint),#
                   day  = rep(day, 3), #
                   time = rep(time, 3))#
traf$Speed <- with(traf, Flow/Occ) #
#
cols <- matrix(c("#3d3d3d", "#969696", "#0868ac", "#4eb3d3", "#7d26cd", "#e066ff"), #
               nrow = 3, byrow = TRUE)#
#
spRange <- range(traf$Speed, na.rm = TRUE)#
ocRange <- range(traf$Occ)#
flRange <- range(traf$Flow)
x1 <- 450;  x2 <- 1280#
y1 <- 0.036; y2 <- 0.15#
slope <- (y2 - y1)/(x2 - x1)#
icept <- y1 - x1*slope#
cong <- traf$Occ >= slope*traf$Speed + icept
par(mfrow = c(2, 1))#
    plot(traf$Flow[traf$lane == 1], type = "l", xaxt = "n", #
         xlab = "time of the day", ylab = "Flow", col = cols[1, 1])#
    lines(traf$Flow[traf$lane == 2], col = cols[2, 1])#
    lines(traf$Flow[traf$lane == 3], col = cols[3, 1])#
    if (input$time) #
      axis(1, at = seq(0, nint, by = 12*3), labels = rep(seq(0, 21, by = 3), #
          length.out = nint/(12*3) + 1))#
    if (input$day)#
      axis(3, at = seq(24*12/2, nint, by = 24*12), tick = FALSE, line = -0.5,#
           labels = c("Friday", "Saturday", "Sunday", "Monday", "Tuesday", "Wednesday"))#
    plot(traf$Occ[traf$lane == 1], type = "l", xaxt = "n", #
         xlab = "time of the day", ylab = "Occupancy", col = cols[1, 1])#
    lines(traf$Occ[traf$lane == 2], col = cols[2, 1])#
    lines(traf$Occ[traf$lane == 3], col = cols[3, 1])#
    legend("topleft", col = cols[, 1], legend = c("left", "middle", "right"), lwd = 2, cex = 0.8)#
    if (input$time) #
      axis(1, at = seq(0, nint, by = 12*3), labels = rep(seq(0, 21, by = 3), #
                                                         length.out = nint/(12*3) + 1))#
    if (input$day)#
      axis(3, at = seq(24*12/2, nint, by = 24*12), tick = FALSE, line = -0.5,#
           labels = c("Friday", "Saturday", "Sunday", "Monday", "Tuesday", "Wednesday"))
axis(1, at = seq(0, nint, by = 12*3), labels = rep(seq(0, 21, by = 3), #
                                                         length.out = nint/(12*3) + 1))
axis(3, at = seq(24*12/2, nint, by = 24*12), tick = FALSE, line = -0.5,#
           labels = c("Friday", "Saturday", "Sunday", "Monday", "Tuesday", "Wednesday"))
?par
par(mfrow = c(2, 1))#
    plot(traf$Flow[traf$lane == 1], type = "l", xaxt = "n", mar = c(2, 3, 3, 3) + 0.1,#
         xlab = "time of the day", ylab = "Flow", col = cols[1, 1])#
    lines(traf$Flow[traf$lane == 2], col = cols[2, 1])#
    lines(traf$Flow[traf$lane == 3], col = cols[3, 1])#
#    if (input$time) #
      axis(1, at = seq(0, nint, by = 12*3), labels = rep(seq(0, 21, by = 3), #
          length.out = nint/(12*3) + 1))#
#    if (input$day)#
      axis(3, at = seq(24*12/2, nint, by = 24*12), tick = FALSE, line = -0.5,#
           labels = c("Friday", "Saturday", "Sunday", "Monday", "Tuesday", "Wednesday"))#
    plot(traf$Occ[traf$lane == 1], type = "l", xaxt = "n", mar = c(3, 3, 2, 3) + 0.1,#
         xlab = "time of the day", ylab = "Occupancy", col = cols[1, 1])#
    lines(traf$Occ[traf$lane == 2], col = cols[2, 1])#
    lines(traf$Occ[traf$lane == 3], col = cols[3, 1])#
    legend("topleft", col = cols[, 1], legend = c("left", "middle", "right"), lwd = 2, cex = 0.8)#
#    if (input$time) #
      axis(1, at = seq(0, nint, by = 12*3), labels = rep(seq(0, 21, by = 3), #
                                                         length.out = nint/(12*3) + 1))#
#    if (input$day)#
      axis(3, at = seq(24*12/2, nint, by = 24*12), tick = FALSE, line = -0.5,#
           labels = c("Friday", "Saturday", "Sunday", "Monday", "Tuesday", "Wednesday"))
plot(1:10)
par(mfrow = c(1, 1))
plot(1:10)
plot(1:10, mar = c(2, 2, 2, 2) + 0.1)
par(mar = c(2, 2, 2, 2) + 0.1)
plot(1:10)
par(mfrow = c(2, 1), mar = c(2, 3, 3, 2) + 0.1)#
    plot(traf$Flow[traf$lane == 1], type = "l", xaxt = "n", mar = c(5, 4, 4, 2) + 0.1,#
         xlab = "time of the day", ylab = "Flow", col = cols[1, 1])#
    lines(traf$Flow[traf$lane == 2], col = cols[2, 1])#
    lines(traf$Flow[traf$lane == 3], col = cols[3, 1])#
#    if (input$time) #
#      axis(1, at = seq(0, nint, by = 12*3), labels = rep(seq(0, 21, by = 3), #
#          length.out = nint/(12*3) + 1))#
#    if (input$day)#
      axis(3, at = seq(24*12/2, nint, by = 24*12), tick = FALSE, line = -0.5,#
           labels = c("Friday", "Saturday", "Sunday", "Monday", "Tuesday", "Wednesday"))#
    par(mar = c(4, 3, 2, 2) + 0.1)#
    plot(traf$Occ[traf$lane == 1], type = "l", xaxt = "n", mar = c(3, 3, 2, 3) + 0.1,#
         xlab = "time of the day", ylab = "Occupancy", col = cols[1, 1])#
    lines(traf$Occ[traf$lane == 2], col = cols[2, 1])#
    lines(traf$Occ[traf$lane == 3], col = cols[3, 1])#
    legend("topleft", col = cols[, 1], legend = c("left", "middle", "right"), lwd = 2, cex = 0.8)#
#    if (input$time) #
      axis(1, at = seq(0, nint, by = 12*3), labels = rep(seq(0, 21, by = 3), #
                                                         length.out = nint/(12*3) + 1))
par(mfrow = c(2, 1), mar = c(1.5, 4, 3, 2) + 0.1)#
    plot(traf$Flow[traf$lane == 1], type = "l", xaxt = "n", mar = c(5, 4, 4, 2) + 0.1,#
         xlab = "time of the day", ylab = "Flow", col = cols[1, 1])#
    lines(traf$Flow[traf$lane == 2], col = cols[2, 1])#
    lines(traf$Flow[traf$lane == 3], col = cols[3, 1])#
#    if (input$time) #
#      axis(1, at = seq(0, nint, by = 12*3), labels = rep(seq(0, 21, by = 3), #
#          length.out = nint/(12*3) + 1))#
#    if (input$day)#
      axis(3, at = seq(24*12/2, nint, by = 24*12), tick = FALSE, line = -0.5,#
           labels = c("Friday", "Saturday", "Sunday", "Monday", "Tuesday", "Wednesday"))#
    par(mar = c(5, 4, 1.5, 2) + 0.1)#
    plot(traf$Occ[traf$lane == 1], type = "l", xaxt = "n", mar = c(3, 3, 2, 3) + 0.1,#
         xlab = "time of the day", ylab = "Occupancy", col = cols[1, 1])#
    lines(traf$Occ[traf$lane == 2], col = cols[2, 1])#
    lines(traf$Occ[traf$lane == 3], col = cols[3, 1])#
    legend("topleft", col = cols[, 1], legend = c("left", "middle", "right"), lwd = 2, cex = 0.8)#
#    if (input$time) #
      axis(1, at = seq(0, nint, by = 12*3), labels = rep(seq(0, 21, by = 3), #
                                                         length.out = nint/(12*3) + 1))#
#    if (input$day)#
#      axis(3, at = seq(24*12/2, nint, by = 24*12), tick = FALSE, line = -0.5,#
#           labels = c("Friday", "Saturday", "Sunday", "Monday", "Tuesday", "Wednesday"))  #
    par(mfrow = c(1, 1), mar = c(5, 4, 4, 2) + 0.1)
par(mfrow = c(2, 1), mar = c(1.5, 4, 3.5, 2) + 0.1)#
    plot(traf$Flow[traf$lane == 1], type = "l", xaxt = "n", mar = c(5, 4, 4, 2) + 0.1,#
         xlab = "time of the day", ylab = "Flow", col = cols[1, 1])#
    lines(traf$Flow[traf$lane == 2], col = cols[2, 1])#
    lines(traf$Flow[traf$lane == 3], col = cols[3, 1])#
#    if (input$time) #
#      axis(1, at = seq(0, nint, by = 12*3), labels = rep(seq(0, 21, by = 3), #
#          length.out = nint/(12*3) + 1))#
#    if (input$day)#
      axis(3, at = seq(24*12/2, nint, by = 24*12), tick = FALSE, line = -0.5,#
           labels = c("Friday", "Saturday", "Sunday", "Monday", "Tuesday", "Wednesday"))#
    par(mar = c(5, 4, 0, 2) + 0.1)#
    plot(traf$Occ[traf$lane == 1], type = "l", xaxt = "n", mar = c(3, 3, 2, 3) + 0.1,#
         xlab = "time of the day", ylab = "Occupancy", col = cols[1, 1])#
    lines(traf$Occ[traf$lane == 2], col = cols[2, 1])#
    lines(traf$Occ[traf$lane == 3], col = cols[3, 1])#
    legend("topleft", col = cols[, 1], legend = c("left", "middle", "right"), lwd = 2, cex = 0.8)#
#    if (input$time) #
      axis(1, at = seq(0, nint, by = 12*3), labels = rep(seq(0, 21, by = 3), #
                                                         length.out = nint/(12*3) + 1))#
#    if (input$day)#
#      axis(3, at = seq(24*12/2, nint, by = 24*12), tick = FALSE, line = -0.5,#
#           labels = c("Friday", "Saturday", "Sunday", "Monday", "Tuesday", "Wednesday"))  #
    par(mfrow = c(1, 1), mar = c(5, 4, 4, 2) + 0.1)
par(mfrow = c(2, 1), mar = c(2, 4, 3, 2) + 0.1)#
    plot(traf$Flow[traf$lane == 1], type = "l", xaxt = "n", mar = c(5, 4, 4, 2) + 0.1,#
         xlab = "time of the day", ylab = "Flow", col = cols[1, 1])#
    lines(traf$Flow[traf$lane == 2], col = cols[2, 1])#
    lines(traf$Flow[traf$lane == 3], col = cols[3, 1])#
#    if (input$time) #
#      axis(1, at = seq(0, nint, by = 12*3), labels = rep(seq(0, 21, by = 3), #
#          length.out = nint/(12*3) + 1))#
#    if (input$day)#
      axis(3, at = seq(24*12/2, nint, by = 24*12), tick = FALSE, line = -0.5,#
           labels = c("Friday", "Saturday", "Sunday", "Monday", "Tuesday", "Wednesday"))#
    par(mar = c(5, 4, 0, 2) + 0.1)#
    plot(traf$Occ[traf$lane == 1], type = "l", xaxt = "n", mar = c(3, 3, 2, 3) + 0.1,#
         xlab = "time of the day", ylab = "Occupancy", col = cols[1, 1])#
    lines(traf$Occ[traf$lane == 2], col = cols[2, 1])#
    lines(traf$Occ[traf$lane == 3], col = cols[3, 1])#
    legend("topleft", col = cols[, 1], legend = c("left", "middle", "right"), lwd = 2, cex = 0.8)#
#    if (input$time) #
      axis(1, at = seq(0, nint, by = 12*3), labels = rep(seq(0, 21, by = 3), #
                                                         length.out = nint/(12*3) + 1))#
#    if (input$day)#
#      axis(3, at = seq(24*12/2, nint, by = 24*12), tick = FALSE, line = -0.5,#
#           labels = c("Friday", "Saturday", "Sunday", "Monday", "Tuesday", "Wednesday"))  #
    par(mfrow = c(1, 1), mar = c(5, 4, 4, 2) + 0.1)
?axis
?mtext
x1 <- 450;  x2 <- 1280#
y1 <- 0.036; y2 <- 0.15#
slope <- (y2 - y1)/(x2 - x1)#
icept <- y1 - x1*slope#
cong <- traf$Occ >= slope*traf$Speed + icept#
#
    par(mfrow = c(3, 1))#
    plot(traf$Flow[traf$lane == 1],  pch = c(1, 19)[rvals$cong[traf$lane == 1] + 1], #
         cex = c(0.5, 0.7)[rvals$cong[traf$lane == 1] + 1],#
         col = cols[1, ][rvals$cong[traf$lane == 1] + 1],#
         xaxt = "n", xlab = "time of day", ylab = "Flow", xlim = rvals$brush)#
    points(traf$Flow[traf$lane == 2], pch = c(1, 19)[rvals$cong[traf$lane == 2] + 1], #
           cex = c(0.5, 0.7)[rvals$cong[traf$lane == 2] + 1],#
           col = cols[2, ][rvals$cong[traf$lane == 2] + 1])#
    points(traf$Flow[traf$lane == 3], pch = c(1, 19)[rvals$cong[traf$lane == 3] + 1], #
           cex = c(0.5, 0.7)[rvals$cong[traf$lane == 3] + 1],#
           col = cols[3, ][rvals$cong[traf$lane == 3] + 1])#
    points(ifelse(rvals$clickInd %% nint != 0, rvals$clickInd %% nint, nint),#
           traf[rvals$clickInd, "Flow"], pch = 21, cex = 1.5, bg = "green", col = 1)  #
    axis(1, at = seq(0, nint, by = 12), labels = rep(seq(0, 23, by = 1), #
                                                     length.out = nint/12 + 1))#
    axis(3, at = seq(24*12/2, nint, by = 24*12), tick = FALSE, line = -0.5,#
         labels = c("Friday", "Saturday", "Sunday", "Monday", "Tuesday", "Wednesday"))#
    plot(traf$Occ[traf$lane == 1],  pch = 19, cex = 0.5, xlim = rvals$brush,#
         col = cols[1, ][rvals$cong[traf$lane == 1] + 1],#
         xaxt = "n", xlab = "time of day", ylab = "Occupancy")#
    points(traf$Occ[traf$lane == 2], pch = 19, cex = 0.5, #
           col = cols[2, ][rvals$cong[traf$lane == 2] + 1])#
    points(traf$Occ[traf$lane == 3], pch = 19, cex = 0.5, #
           col = cols[3, ][rvals$cong[traf$lane == 3] + 1])#
    points(ifelse(rvals$clickInd %% nint != 0, rvals$clickInd %% nint, nint),#
           traf[rvals$clickInd, "Occ"], pch = 23, cex = 1.5, bg = "green")  #
    axis(1, at = seq(0, nint, by = 12), labels = rep(seq(0, 23, by = 1), #
                                                     length.out = nint/12 + 1))#
    axis(3, at = seq(24*12/2, nint, by = 24*12), tick = FALSE, line = -0.5,#
         labels = c("Friday", "Saturday", "Sunday", "Monday", "Tuesday", "Wednesday"))#
    legend("topleft", col = cols[, 1], legend = c("left", "middle", "right"), #
           lwd = 2)#
    plot(traf$Speed[traf$lane == 1],  pch = 1, cex = 0.5, xlim = rvals$brush,#
         col = cols[1, ][rvals$cong[traf$lane == 1] + 1],#
         xaxt = "n", xlab = "time of day", ylab = "Speed", yaxt = "n")#
    points(traf$Speed[traf$lane == 2], pch = 1, cex = 0.5, #
           col = cols[2, ][rvals$cong[traf$lane == 2] + 1])#
    points(traf$Speed[traf$lane == 3], pch = 1, cex = 0.5, #
           col = cols[3, ][rvals$cong[traf$lane == 3] + 1])#
    points(traf$Speed[traf$lane == 1], pch = 1, cex = 0.5, #
           col = cols[1, ][rvals$cong[traf$lane == 1] + 1])#
    points(ifelse(rvals$clickInd %% nint != 0, rvals$clickInd %% nint, nint),#
           traf[rvals$clickInd, "Speed"], pch = 24, cex = 1.5, bg = "green")  #
    axis(1, at = seq(0, nint, by = 12), labels = rep(seq(0, 23, by = 1), #
                                                     length.out = nint/12 + 1))#
    axis(3, at = seq(24*12/2, nint, by = 24*12), tick = FALSE, line = -0.5,#
         labels = c("Friday", "Saturday", "Sunday", "Monday", "Tuesday", "Wednesday"))
rvals <- list(cong = cong)
par(mfrow = c(3, 1))#
    plot(traf$Flow[traf$lane == 1],  pch = c(1, 19)[rvals$cong[traf$lane == 1] + 1], #
         cex = c(0.5, 0.7)[rvals$cong[traf$lane == 1] + 1],#
         col = cols[1, ][rvals$cong[traf$lane == 1] + 1],#
         xaxt = "n", xlab = "time of day", ylab = "Flow", xlim = rvals$brush)#
    points(traf$Flow[traf$lane == 2], pch = c(1, 19)[rvals$cong[traf$lane == 2] + 1], #
           cex = c(0.5, 0.7)[rvals$cong[traf$lane == 2] + 1],#
           col = cols[2, ][rvals$cong[traf$lane == 2] + 1])#
    points(traf$Flow[traf$lane == 3], pch = c(1, 19)[rvals$cong[traf$lane == 3] + 1], #
           cex = c(0.5, 0.7)[rvals$cong[traf$lane == 3] + 1],#
           col = cols[3, ][rvals$cong[traf$lane == 3] + 1])#
    points(ifelse(rvals$clickInd %% nint != 0, rvals$clickInd %% nint, nint),#
           traf[rvals$clickInd, "Flow"], pch = 21, cex = 1.5, bg = "green", col = 1)  #
    axis(1, at = seq(0, nint, by = 12), labels = rep(seq(0, 23, by = 1), #
                                                     length.out = nint/12 + 1))#
    axis(3, at = seq(24*12/2, nint, by = 24*12), tick = FALSE, line = -0.5,#
         labels = c("Friday", "Saturday", "Sunday", "Monday", "Tuesday", "Wednesday"))#
    plot(traf$Occ[traf$lane == 1],  pch = 19, cex = 0.5, xlim = rvals$brush,#
         col = cols[1, ][rvals$cong[traf$lane == 1] + 1],#
         xaxt = "n", xlab = "time of day", ylab = "Occupancy")#
    points(traf$Occ[traf$lane == 2], pch = 19, cex = 0.5, #
           col = cols[2, ][rvals$cong[traf$lane == 2] + 1])#
    points(traf$Occ[traf$lane == 3], pch = 19, cex = 0.5, #
           col = cols[3, ][rvals$cong[traf$lane == 3] + 1])#
    points(ifelse(rvals$clickInd %% nint != 0, rvals$clickInd %% nint, nint),#
           traf[rvals$clickInd, "Occ"], pch = 23, cex = 1.5, bg = "green")  #
    axis(1, at = seq(0, nint, by = 12), labels = rep(seq(0, 23, by = 1), #
                                                     length.out = nint/12 + 1))#
    axis(3, at = seq(24*12/2, nint, by = 24*12), tick = FALSE, line = -0.5,#
         labels = c("Friday", "Saturday", "Sunday", "Monday", "Tuesday", "Wednesday"))#
    legend("topleft", col = cols[, 1], legend = c("left", "middle", "right"), #
           lwd = 2)#
    plot(traf$Speed[traf$lane == 1],  pch = 1, cex = 0.5, xlim = rvals$brush,#
         col = cols[1, ][rvals$cong[traf$lane == 1] + 1],#
         xaxt = "n", xlab = "time of day", ylab = "Speed", yaxt = "n")#
    points(traf$Speed[traf$lane == 2], pch = 1, cex = 0.5, #
           col = cols[2, ][rvals$cong[traf$lane == 2] + 1])#
    points(traf$Speed[traf$lane == 3], pch = 1, cex = 0.5, #
           col = cols[3, ][rvals$cong[traf$lane == 3] + 1])#
    points(traf$Speed[traf$lane == 1], pch = 1, cex = 0.5, #
           col = cols[1, ][rvals$cong[traf$lane == 1] + 1])#
    points(ifelse(rvals$clickInd %% nint != 0, rvals$clickInd %% nint, nint),#
           traf[rvals$clickInd, "Speed"], pch = 24, cex = 1.5, bg = "green")  #
    axis(1, at = seq(0, nint, by = 12), labels = rep(seq(0, 23, by = 1), #
                                                     length.out = nint/12 + 1))#
    axis(3, at = seq(24*12/2, nint, by = 24*12), tick = FALSE, line = -0.5,#
         labels = c("Friday", "Saturday", "Sunday", "Monday", "Tuesday", "Wednesday"))
library(RColorBrewer)
plot(1:10, col = cols, pch = 16, cex = 5)
par(mfrow = c(1, 1))
plot(1:10, col = cols, pch = 16, cex = 5)
col.light <- c("turquoise", "violet", "tan")
plot(1:10, col = c(cols, col.light), pch = 16, cex = 5)
col.light <- c("turquoise", "violet", "tan", "peachpuff3", "khaki3")
plot(1:12, col = c(cols, col.light), pch = 16, cex = 5)
col.light <- c("turquoise", "tan", "khaki3", "palevioletred", "violetred1", "maroon1")
plot(1:12, col = c(cols, col.light), pch = 16, cex = 5)
col.light <- c("turquoise", "tan", "khaki3", "palevioletred", "violetred1", #
               "maroon2", "sandybrown")
plot(1:14, col = c(cols, col.light), pch = 16, cex = 5)
col.light <- c("turquoise", "tan", "khaki3", "palevioletred", "violetred1", #
               "maroon2", "sandybrown", "peachpuff3")
plot(1:14, col = c(cols, col.light), pch = 16, cex = 5)
cols <- matrix(c("#3d3d3d", "#969696", "#0868ac", #
                 "peachpuff3", "turquoise", "palevioletred"), nrow = 3, byrow = TRUE)
par(mfrow = c(2, 1), mar = c(2, 4, 35, 2) + 0.1)#
    plot(traf$Flow[traf$lane == 1], type = "l", xaxt = "n", mar = c(5, 4, 4, 2) + 0.1,#
         xlab = "time of the day", ylab = "Flow", col = cols[1, 1])#
    lines(traf$Flow[traf$lane == 2], col = cols[2, 1])#
    lines(traf$Flow[traf$lane == 3], col = cols[3, 1])#
#    if (input$time) #
#      axis(1, at = seq(0, nint, by = 12*3), labels = rep(seq(0, 21, by = 3), #
#          length.out = nint/(12*3) + 1))#
#    if (input$day)#
      axis(3, at = seq(24*12/2, nint, by = 24*12), tick = FALSE, line = -0.5,#
           labels = c("Friday", "Saturday", "Sunday", "Monday", "Tuesday", "Wednesday"))#
    par(mar = c(5, 4, 0, 2) + 0.1)#
    plot(traf$Occ[traf$lane == 1], type = "l", xaxt = "n", mar = c(3, 3, 2, 3) + 0.1,#
         xlab = "time of the day", ylab = "Occupancy", col = cols[1, 1])#
    lines(traf$Occ[traf$lane == 2], col = cols[2, 1])#
    lines(traf$Occ[traf$lane == 3], col = cols[3, 1])#
    legend("topleft", col = cols[, 1], legend = c("left", "middle", "right"), lwd = 2, cex = 0.8)#
#    if (input$time) #
      axis(1, at = seq(0, nint, by = 12*3), labels = rep(seq(0, 21, by = 3), #
                                                         length.out = nint/(12*3) + 1))#
#    if (input$day)#
#      axis(3, at = seq(24*12/2, nint, by = 24*12), tick = FALSE, line = -0.5,#
#           labels = c("Friday", "Saturday", "Sunday", "Monday", "Tuesday", "Wednesday"))  #
    par(mfrow = c(1, 1), mar = c(5, 4, 4, 2) + 0.1)
par(mfrow = c(3, 1))#
    plot(traf$Flow[traf$lane == 1],  pch = c(1, 19)[rvals$cong[traf$lane == 1] + 1], #
         cex = c(0.5, 0.7)[rvals$cong[traf$lane == 1] + 1],#
         col = cols[1, ][rvals$cong[traf$lane == 1] + 1],#
         xaxt = "n", xlab = "time of day", ylab = "Flow", xlim = rvals$brush)#
    points(traf$Flow[traf$lane == 2], pch = c(1, 19)[rvals$cong[traf$lane == 2] + 1], #
           cex = c(0.5, 0.7)[rvals$cong[traf$lane == 2] + 1],#
           col = cols[2, ][rvals$cong[traf$lane == 2] + 1])#
    points(traf$Flow[traf$lane == 3], pch = c(1, 19)[rvals$cong[traf$lane == 3] + 1], #
           cex = c(0.5, 0.7)[rvals$cong[traf$lane == 3] + 1],#
           col = cols[3, ][rvals$cong[traf$lane == 3] + 1])#
    points(ifelse(rvals$clickInd %% nint != 0, rvals$clickInd %% nint, nint),#
           traf[rvals$clickInd, "Flow"], pch = 21, cex = 1.5, bg = "green", col = 1)  #
    axis(1, at = seq(0, nint, by = 12), labels = rep(seq(0, 23, by = 1), #
                                                     length.out = nint/12 + 1))#
    axis(3, at = seq(24*12/2, nint, by = 24*12), tick = FALSE, line = -0.5,#
         labels = c("Friday", "Saturday", "Sunday", "Monday", "Tuesday", "Wednesday"))#
    plot(traf$Occ[traf$lane == 1],  pch = 19, cex = 0.5, xlim = rvals$brush,#
         col = cols[1, ][rvals$cong[traf$lane == 1] + 1],#
         xaxt = "n", xlab = "time of day", ylab = "Occupancy")#
    points(traf$Occ[traf$lane == 2], pch = 19, cex = 0.5, #
           col = cols[2, ][rvals$cong[traf$lane == 2] + 1])#
    points(traf$Occ[traf$lane == 3], pch = 19, cex = 0.5, #
           col = cols[3, ][rvals$cong[traf$lane == 3] + 1])#
    points(ifelse(rvals$clickInd %% nint != 0, rvals$clickInd %% nint, nint),#
           traf[rvals$clickInd, "Occ"], pch = 23, cex = 1.5, bg = "green")  #
    axis(1, at = seq(0, nint, by = 12), labels = rep(seq(0, 23, by = 1), #
                                                     length.out = nint/12 + 1))#
    axis(3, at = seq(24*12/2, nint, by = 24*12), tick = FALSE, line = -0.5,#
         labels = c("Friday", "Saturday", "Sunday", "Monday", "Tuesday", "Wednesday"))#
    legend("topleft", col = cols[, 1], legend = c("left", "middle", "right"), #
           lwd = 2)#
    plot(traf$Speed[traf$lane == 1],  pch = 1, cex = 0.5, xlim = rvals$brush,#
         col = cols[1, ][rvals$cong[traf$lane == 1] + 1],#
         xaxt = "n", xlab = "time of day", ylab = "Speed", yaxt = "n")#
    points(traf$Speed[traf$lane == 2], pch = 1, cex = 0.5, #
           col = cols[2, ][rvals$cong[traf$lane == 2] + 1])#
    points(traf$Speed[traf$lane == 3], pch = 1, cex = 0.5, #
           col = cols[3, ][rvals$cong[traf$lane == 3] + 1])#
    points(traf$Speed[traf$lane == 1], pch = 1, cex = 0.5, #
           col = cols[1, ][rvals$cong[traf$lane == 1] + 1])#
    points(ifelse(rvals$clickInd %% nint != 0, rvals$clickInd %% nint, nint),#
           traf[rvals$clickInd, "Speed"], pch = 24, cex = 1.5, bg = "green")  #
    axis(1, at = seq(0, nint, by = 12), labels = rep(seq(0, 23, by = 1), #
                                                     length.out = nint/12 + 1))
cols <- matrix(c("#3d3d3d", "peachpuff3", "#969696", "turquoise", "#0868ac", "palevioletred"),#
               nrow = 3, byrow = TRUE)
par(mfrow = c(3, 1))#
    plot(traf$Flow[traf$lane == 1],  pch = c(1, 19)[rvals$cong[traf$lane == 1] + 1], #
         cex = c(0.5, 0.7)[rvals$cong[traf$lane == 1] + 1],#
         col = cols[1, ][rvals$cong[traf$lane == 1] + 1],#
         xaxt = "n", xlab = "time of day", ylab = "Flow", xlim = rvals$brush)#
    points(traf$Flow[traf$lane == 2], pch = c(1, 19)[rvals$cong[traf$lane == 2] + 1], #
           cex = c(0.5, 0.7)[rvals$cong[traf$lane == 2] + 1],#
           col = cols[2, ][rvals$cong[traf$lane == 2] + 1])#
    points(traf$Flow[traf$lane == 3], pch = c(1, 19)[rvals$cong[traf$lane == 3] + 1], #
           cex = c(0.5, 0.7)[rvals$cong[traf$lane == 3] + 1],#
           col = cols[3, ][rvals$cong[traf$lane == 3] + 1])#
    points(ifelse(rvals$clickInd %% nint != 0, rvals$clickInd %% nint, nint),#
           traf[rvals$clickInd, "Flow"], pch = 21, cex = 1.5, bg = "green", col = 1)  #
    axis(1, at = seq(0, nint, by = 12), labels = rep(seq(0, 23, by = 1), #
                                                     length.out = nint/12 + 1))#
    axis(3, at = seq(24*12/2, nint, by = 24*12), tick = FALSE, line = -0.5,#
         labels = c("Friday", "Saturday", "Sunday", "Monday", "Tuesday", "Wednesday"))#
    plot(traf$Occ[traf$lane == 1],  pch = 19, cex = 0.5, xlim = rvals$brush,#
         col = cols[1, ][rvals$cong[traf$lane == 1] + 1],#
         xaxt = "n", xlab = "time of day", ylab = "Occupancy")#
    points(traf$Occ[traf$lane == 2], pch = 19, cex = 0.5, #
           col = cols[2, ][rvals$cong[traf$lane == 2] + 1])#
    points(traf$Occ[traf$lane == 3], pch = 19, cex = 0.5, #
           col = cols[3, ][rvals$cong[traf$lane == 3] + 1])#
    points(ifelse(rvals$clickInd %% nint != 0, rvals$clickInd %% nint, nint),#
           traf[rvals$clickInd, "Occ"], pch = 23, cex = 1.5, bg = "green")  #
    axis(1, at = seq(0, nint, by = 12), labels = rep(seq(0, 23, by = 1), #
                                                     length.out = nint/12 + 1))#
    axis(3, at = seq(24*12/2, nint, by = 24*12), tick = FALSE, line = -0.5,#
         labels = c("Friday", "Saturday", "Sunday", "Monday", "Tuesday", "Wednesday"))#
    legend("topleft", col = cols[, 1], legend = c("left", "middle", "right"), #
           lwd = 2)#
    plot(traf$Speed[traf$lane == 1],  pch = 1, cex = 0.5, xlim = rvals$brush,#
         col = cols[1, ][rvals$cong[traf$lane == 1] + 1],#
         xaxt = "n", xlab = "time of day", ylab = "Speed", yaxt = "n")#
    points(traf$Speed[traf$lane == 2], pch = 1, cex = 0.5, #
           col = cols[2, ][rvals$cong[traf$lane == 2] + 1])#
    points(traf$Speed[traf$lane == 3], pch = 1, cex = 0.5, #
           col = cols[3, ][rvals$cong[traf$lane == 3] + 1])#
    points(traf$Speed[traf$lane == 1], pch = 1, cex = 0.5, #
           col = cols[1, ][rvals$cong[traf$lane == 1] + 1])#
    points(ifelse(rvals$clickInd %% nint != 0, rvals$clickInd %% nint, nint),#
           traf[rvals$clickInd, "Speed"], pch = 24, cex = 1.5, bg = "green")  #
    axis(1, at = seq(0, nint, by = 12), labels = rep(seq(0, 23, by = 1), #
                                                     length.out = nint/12 + 1))
plot(1:6, col = cols)
cols <- matrix(c("#3d3d3d", "#0868ac", "#7d26cd", #
                 "peachpuff3", "turquoise", "palevioletred"), nrow = 3)
par(mfrow = c(3, 1))#
    plot(traf$Flow[traf$lane == 1],  pch = c(1, 19)[rvals$cong[traf$lane == 1] + 1], #
         cex = c(0.5, 0.7)[rvals$cong[traf$lane == 1] + 1],#
         col = cols[1, ][rvals$cong[traf$lane == 1] + 1],#
         xaxt = "n", xlab = "time of day", ylab = "Flow", xlim = rvals$brush)#
    points(traf$Flow[traf$lane == 2], pch = c(1, 19)[rvals$cong[traf$lane == 2] + 1], #
           cex = c(0.5, 0.7)[rvals$cong[traf$lane == 2] + 1],#
           col = cols[2, ][rvals$cong[traf$lane == 2] + 1])#
    points(traf$Flow[traf$lane == 3], pch = c(1, 19)[rvals$cong[traf$lane == 3] + 1], #
           cex = c(0.5, 0.7)[rvals$cong[traf$lane == 3] + 1],#
           col = cols[3, ][rvals$cong[traf$lane == 3] + 1])#
    points(ifelse(rvals$clickInd %% nint != 0, rvals$clickInd %% nint, nint),#
           traf[rvals$clickInd, "Flow"], pch = 21, cex = 1.5, bg = "green", col = 1)  #
    axis(1, at = seq(0, nint, by = 12), labels = rep(seq(0, 23, by = 1), #
                                                     length.out = nint/12 + 1))#
    axis(3, at = seq(24*12/2, nint, by = 24*12), tick = FALSE, line = -0.5,#
         labels = c("Friday", "Saturday", "Sunday", "Monday", "Tuesday", "Wednesday"))#
    plot(traf$Occ[traf$lane == 1],  pch = 19, cex = 0.5, xlim = rvals$brush,#
         col = cols[1, ][rvals$cong[traf$lane == 1] + 1],#
         xaxt = "n", xlab = "time of day", ylab = "Occupancy")#
    points(traf$Occ[traf$lane == 2], pch = 19, cex = 0.5, #
           col = cols[2, ][rvals$cong[traf$lane == 2] + 1])#
    points(traf$Occ[traf$lane == 3], pch = 19, cex = 0.5, #
           col = cols[3, ][rvals$cong[traf$lane == 3] + 1])#
    points(ifelse(rvals$clickInd %% nint != 0, rvals$clickInd %% nint, nint),#
           traf[rvals$clickInd, "Occ"], pch = 23, cex = 1.5, bg = "green")  #
    axis(1, at = seq(0, nint, by = 12), labels = rep(seq(0, 23, by = 1), #
                                                     length.out = nint/12 + 1))#
    axis(3, at = seq(24*12/2, nint, by = 24*12), tick = FALSE, line = -0.5,#
         labels = c("Friday", "Saturday", "Sunday", "Monday", "Tuesday", "Wednesday"))#
    legend("topleft", col = cols[, 1], legend = c("left", "middle", "right"), #
           lwd = 2)#
    plot(traf$Speed[traf$lane == 1],  pch = 1, cex = 0.5, xlim = rvals$brush,#
         col = cols[1, ][rvals$cong[traf$lane == 1] + 1],#
         xaxt = "n", xlab = "time of day", ylab = "Speed", yaxt = "n")#
    points(traf$Speed[traf$lane == 2], pch = 1, cex = 0.5, #
           col = cols[2, ][rvals$cong[traf$lane == 2] + 1])#
    points(traf$Speed[traf$lane == 3], pch = 1, cex = 0.5, #
           col = cols[3, ][rvals$cong[traf$lane == 3] + 1])#
    points(traf$Speed[traf$lane == 1], pch = 1, cex = 0.5, #
           col = cols[1, ][rvals$cong[traf$lane == 1] + 1])#
    points(ifelse(rvals$clickInd %% nint != 0, rvals$clickInd %% nint, nint),#
           traf[rvals$clickInd, "Speed"], pch = 24, cex = 1.5, bg = "green")  #
    axis(1, at = seq(0, nint, by = 12), labels = rep(seq(0, 23, by = 1), #
                                                     length.out = nint/12 + 1))
cols <- matrix(c("#3d3d3d", "#0868ac", "#7d26cd", #
                 "bisque4", "darkturquoise", "violetred2"), nrow = 3)
cols.rgb <- col2rgb(cols) #(c4)#
cols.hex <- as.character(as.hexmode(cols.rgb))#
cols <- apply(cols.hex, 2, function(x) paste("#", paste(x, collapse = ""), sep = ""))
cols1 <- matrix(c("#3d3d3d", "#0868ac", "#7d26cd", #
                 "bisque4", "darkturquoise", "violetred2"), nrow = 3)
cols
cols1
plot(1:2, col = c(cols1, cols), pch = 19, cex = 5)
par(mfrow = c(1, 1))
plot(1:2, col = c(cols1, cols), pch = 19, cex = 5)
plot(1:12, col = c(cols1, cols), pch = 19, cex = 5)
cols
cols <- matrix(c("#3d3d3d" "#0868ac" "#7d26cd" "#8b7d6b" "#00ced1" "#ee3a8c"), nrow = 3)
cols <- matrix(c("#3d3d3d", "#0868ac", "#7d26cd", #
                 "#8b7d6b", "#00ced1", "#ee3a8c"), nrow = 3)
cols
myPng <- function(..., width = 7, height = 7, res = 300) {#
	png(..., width = width*res, height = height*res, res = res)#
}#
#
png("/Users/innars/Documents/Projects/DynDocs/trafficJams/traffic/www/figure/speedHist.png", #
     res = 220, width = 9*220, height = 6*220)#
par(mfrow = c(2, 2))#
hist(speed1, breaks = 50, xlim = spRange, xlab = "", col = "lightyellow",#
     main = "Histogram of V, left lane")#
hist(speed2, breaks = 50, xlim = spRange, xlab = "", col = "lightyellow",#
     main = "Histogram of V, middle lane")#
hist(speed3, breaks = 50, xlim = spRange, xlab = "", col = "lightyellow",#
     main = "Histogram of V, right lane")#
boxplot(speed1, speed2, speed3, col = cols[, 2], yaxt = "n", #
        main = "Boxplots of speed in three lanes")#
axis(1, at = 1:3, labels = c("left", "middle", "right")) #
dev.off()
?split
a <- split(Speed, lane, data = traf)
a <- split(traf$Speed, traf$lane)
class(a)
length(a)
boxplot(split(traf$Speed, traf$lane), col = cols[, 2], yaxt = "n", #
        main = "Boxplots of speed in three lanes")
png("/Users/innars/Documents/Projects/DynDocs/trafficJams/traffic/www/figure/speedHist.png", #
     res = 220, width = 9*220, height = 6*220)#
par(mfrow = c(2, 2))#
hist(traf$Speed[traf$lane == 1], breaks = 50, xlim = spRange, xlab = "", col = "lightyellow",#
     main = "Histogram of V, left lane")#
hist(traf$Speed[traf$lane == 2], breaks = 50, xlim = spRange, xlab = "", col = "lightyellow",#
     main = "Histogram of V, middle lane")#
hist(traf$Speed[traf$lane == 3], breaks = 50, xlim = spRange, xlab = "", col = "lightyellow",#
     main = "Histogram of V, right lane")#
boxplot(split(traf$Speed, traf$lane), col = cols[, 2], yaxt = "n", #
        main = "Boxplots of speed in three lanes")#
axis(1, at = 1:3, labels = c("left", "middle", "right")) #
dev.off()
myPng <- function(..., width = 7, height = 7, res = 300) {#
	png(..., width = width*res, height = height*res, res = res)#
}#
#
png("/Users/innars/Documents/Projects/DynDocs/trafficJams/traffic/www/figure/speedHist.png", #
     res = 220, width = 9*220, height = 6*220)#
par(mfrow = c(2, 2))#
hist(traf$Speed[traf$lane == 1], breaks = 50, xlim = spRange, xlab = "", col = "lightyellow",#
     main = "Histogram of V, left lane")#
hist(traf$Speed[traf$lane == 2], breaks = 50, xlim = spRange, xlab = "", col = "lightyellow",#
     main = "Histogram of V, middle lane")#
hist(traf$Speed[traf$lane == 3], breaks = 50, xlim = spRange, xlab = "", col = "lightyellow",#
     main = "Histogram of V, right lane")#
boxplot(split(traf$Speed, traf$lane), col = cols[, 2], yaxt = "n", #
        main = "Boxplots of speed in three lanes")#
axis(1, at = 1:3, labels = c("left", "middle", "right")) #
dev.off()
boxplot(split(traf$Speed, traf$lane), col = cols[, 2], yaxt = "n", #
        main = "Boxplots of speed in three lanes")
boxplot(split(traf$Speed, traf$lane), col = cols[, 2], yaxt = "n", xaxt = "n",#
        main = "Boxplots of speed in three lanes")#
axis(1, at = 1:3, labels = c("left", "middle", "right"))
png("/Users/innars/Documents/Projects/DynDocs/trafficJams/traffic/www/figure/speedHist.png", #
     res = 220, width = 9*220, height = 6*220)#
par(mfrow = c(2, 2))#
hist(traf$Speed[traf$lane == 1], breaks = 50, xlim = spRange, xlab = "", col = "lightyellow",#
     main = "Histogram of V, left lane")#
hist(traf$Speed[traf$lane == 2], breaks = 50, xlim = spRange, xlab = "", col = "lightyellow",#
     main = "Histogram of V, middle lane")#
hist(traf$Speed[traf$lane == 3], breaks = 50, xlim = spRange, xlab = "", col = "lightyellow",#
     main = "Histogram of V, right lane")#
boxplot(split(traf$Speed, traf$lane), col = cols[, 2], yaxt = "n", xaxt = "n",#
        main = "Boxplots of speed in three lanes")#
axis(1, at = 1:3, labels = c("left", "middle", "right")) #
dev.off()
c1 <- "black"
cols.rgb <- col2rgb(c1)
cols.hex <- as.character(as.hexmode(cols.rgb))#
c <- apply(cols.hex, 2, function(x) paste("#", paste(x, collapse = ""), sep = ""))
c
