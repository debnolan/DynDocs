<html>

<head>
  <link rel="stylesheet" type="text/css" href="template.css" />
  <script src="shared/shiny.js" type="text/javascript"></script>
  <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  <script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']],processEscapes: true}});</script>  

</head>

<body >
  <h1>Extreme Value Distributions</h1>
  <h2>Introduction</h2>
  
  <p> In this project, we will look at the probability plot, quantile plot, return
  level plot, and density plot which involves the fitting of data to a Generalized Pareto Distribution using a range of different thresholds and estimate its return values of a weather station in Colarado. 
  </p>

  <h2>Asymptootic Model Characterization</h2>
  <p> The classical asymptotically model for excesses above a high
  threshold is the generalised Pareto distribution. It is often useful to look 
  at the exceedances over a given threshold instead of the maximum or minimum of the data.
  </p>

  <h2>The Generalized Pareto Distribution </h2>
  <p> 
  Suppose X<SUB><FONT size=-1>1</font></sub>,X<SUB><FONT size=-1>2</font></sub>,... be a sequence of i.i.d. random variables with distribution function, <I>F</i>, and let M<SUB><FONT size=-1>n</font></sub> =
  <TT>max</tt>{X<SUB><FONT size=-1>1</font></sub>,...,X<SUB><FONT size=-1>n</font></sub>}. Now,
  assuming that <I>F</i> satisfies certain conditions, then we have that Pr{M<SUB><FONT size=-1>n</font></sub> &le; z} &asymp; G(z), where
  </p>
  
  <p> <img src="/images/GPDderivation2.png"> </p>
    
  <p> 
  for some &mu;, &sigma; &gt; 0 and &xi;.  Then for a large enough threshold, u, the distribution function of GPD (X-&mu;), conditional on X &gt; u, is then given by
  </p>
  
  <img src="/images/GPDdefinition.png"></a>
  
  <p>
    where z=(x-&mu;)/&sigma;, and k, &sigma;, &mu; are the shape, scale, and location parameters respectively. The scale of &sigma; must be positive, the shape and location can take any real numbers.
  </p>
  
  <p>
    The shape parameter &xi; is important to determine the tail distribution of the GPD:
  </p>
  
  <p>&bull; &xi; &lt; 0: short tail with finite upper end point of $u - \frac{&sigma;_u}{&xi;}$ </p>
  <p>&bull; &xi; = 0: exponential tail</p>
  <p>&bull; &xi; &gt; 0: heavy tail</p>
  
  <h2>Outline Justification for the Generalized Pareto Model</h2>
      <h2>Modeling Threshold Excesses</h2>
      <h3>Threshold Selection</h3>
  <p>
  Selection of a threshold that is too low will result biased parameter estimates, but a threshold that is too high will result in large variance of the parameter estimates. The idea of selecting a reasonable approximation is to pick a low threshold for the limit subject model. 
  </p>
  <p>
    Suppose a raw data consist of a sequence of i.i.d. measurements x<SUB><FONT size=-1>1</font></sub>,x<SUB><FONT size=-1>2</font></sub>...,x<SUB><FONT size=-1>n</font></sub> and let x<SUB><FONT size=-1>(-1)</font></sub>,x<SUB><FONT size=-1>(-2)</font></sub>...,x<SUB><FONT size=-1>(k)</font></sub> represent the subset of data points that exceed a particular threshold u and X<SUB><FONT size=-1>max</font></sub> is the largest of X<SUB><FONT size=-1>i</font></sub>. Define threshold excesses by y<SUB><FONT size=-1>j</font></sub> = x<SUB><FONT size=-1>(j)</font></sub>-u for j = 1,...,k. This lead to the following procedure.
  </p> 
  <p> 
    ${(u,${\frac{1}{n_u}}\sum_{i=1}^{n_u} (x_(i) - u)): u < x_max}$
  </p>
  <p>
    It is termed as the mean residual life plot where the plot is approximately linear in threshold, u
  </p>
  
      <h3>Parameter Estimation </h3>
      <p>
        Having determined a threshold, the parameters of the generalized Pareto distribution can be estimated by maximum likelihood. Maximum likelihood estimation of the parameters (k, &alpha;) was considered by DuMouchel (1983), Davison (1984), R. L. Smith (1984, 1987), J. A. Smith (1986), and Joe (1987). To compute the GPD maximum likelihood estimates, There are two values of (k, &alpha;) that must be investigated in order to compute the GPD maximum likelihood estimate, such that $\Re = \{k < 0, &alpha; > 0\} \cup \{0 < k \leq 1, {\frac{&alpha;}{k}} > X_n\}$. The first is the local maximum of the loglikelihood in space $\Re$ and the second is at the boundary space $\Re$, where k = 1. Suppose that X = {X<SUB><FONT size=-1>1</font></sub>,X<SUB><FONT size=-1>2</font></sub> . . , X<SUB><FONT size=-1>n</font></sub>} is a random sample from the GPD with largest value of X<SUB><FONT size=-1>n</font></sub>. Then, the loglikelihood
is given by 
      </p>
      <p>
        $$l(&sigma;, &xi;) = klog&sigma; - (1 + {\frac{1}{&sigma;}})\sum_{i=1}^{k} log(1+{\frac{&xi;y_i}{&sigma;}}),  k \neq 0$$
      </p>
      <p> $$l(&sigma;, &xi;) = -klog&sigma; - {\frac{1}{&sigma;}}\sum_{i=1}^{k} y_i,  k = 0$$ </p>
      
      <p>
      where &sigma; > 0 for k > 0 and &sigma; > kX<SUB><FONT size=-1>(n)</font></sub> for k > 0. If k > 1, then there is no maximum likelihood estimate because $\lim_{{\frac{&alpha;}{k}}\to X^{+}} L(k, &alpha;; X) = \infty$ 
      </p>
      <h3>Return Levels</h3>
      <p>
        When measuring the extreme value models, it is more convenient to interpret them in terms of return levels or quantiles rather than individual parameter values. Return levels are best to measure on the annual scale, so that the N-year return level is the level that is expected to be exceeded once in every N years. Suppose that a generalized Pareto distribution with parameters &sigma; and &xi; is a suitable model for exceedances of a threshold u by a variable X, such that
      </p>
      <p> $$Pr(X > x | X > u) = [1+&xi;({\frac{x-u}{&sigma;}})]^{\frac{-1}{&xi;}}$$</p>
      <p> $$Pr(X > x) = &xi;_u[1 + &xi;({\frac{x_m-u}{&sigma;}})]^{\frac{-1}{&xi;}} = {\frac{1}{m}}$$ </p>
      <p> where x<SUB><FONT size=-1>m</font></sub> is the m observation return level which it exceeds the average on every m observations and &xi; $\neq$ 0 
      </p>

  <h3>Application of GEV distribution</h3>
  <p> In our present work, we first pick a weather station in Colorado and calculate daily maximum precipitation and the number of heavy rainfall events. From the fitted distribution, we can estimate how often the extreme quantiles occur with a certain return level. The return value is defined as a value that is expected to be equaled or exceeded on average once every interval of time. We calculated return values for 2-, 5-, 10-, 20-yr, 100-yr and 200-yr return period at each grid point.
  </p>


</body>
</html>
