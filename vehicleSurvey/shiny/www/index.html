<!DOCTYPE html>
<html>
 <head>
 <script src="shared/jquery.js" type="text/javascript"></script>
  <script src="shared/shiny.js" type="text/javascript"></script>
 </head>

 <body>
  <h1>Bootstrap Analysis</h1>
  <p>
 The Vehicle Inventory and Use Survey (VIUS) has been conducted by
  the U.S. government to provide information on the number of private
  and commercial trucks in each state. In the 2002 VIUS-CA survey,
  2192 trucks were surveyed and 5 strata were formed from the sampling
  frame of truck registrations using stratification variable
  trucktype.  The truck registrations were partitioned into one of five classes:
<div>
  1. Pickups
</div>
<div>
  2. Minivans, other light vans, and sport utility vehicles
</div>
<div>
3. Light single-unit trucks with gross vehicle weight less than 26,000
  pounds
</div>
<div>
4. Heavy single-unit trucks with gross vehicle weight greater than or
  equal to 26,000 pounds
</div>
<div>
  5. Truck-tractors
</div><br/>
Based on these five strata and their weights, the median number of
  miles driven in 2002 in California was 10254 miles. 
  </p>
<table border=1>
  <tr> <th>TruckTypes</th> <th> Sample Size</th><th> Sampling Weight</th><th>Median</th> </tr>
  <tr> <td align="middle"> Pickups</td> <td align="middle">219 </td> <td align="middle">18410.0</td> <td align="middle">10000</td></tr>
  <tr> <td align="middle"> Vans </td> <td align="middle"> 275 </td><td align="middle">17078.6</td> <td align="middle">11000</td> </tr>
  <tr> <td align="middle"> Light</td> <td align="middle"> 565 </td><td align="middle">608.9</td> <td align="middle">11000</td> </tr>
  <tr> <td align="middle"> Heavy</td> <td align="middle"> 546 </td> <td align="middle">155.6</td> <td align="middle">19924</td></tr>
  <tr> <td align="middle"> Truck-Tractors</td> <td align="middle">587 </td> <td align="middle">150.3</td> <td align="middle">44640</td></tr>
</table>
</p>

<p>
To bootstrap, we resample the data from survey samples with
replacement multipe times. Because the survey samples are stratified,
we take bootstrap resamples within each stratum. For every resample,
we are able to calculate its statistic data such as mean, median. In
this data set, our estimator is median. By replicating a certain number
of times, we are able to get the same number of medians.
</p>
  
  <div id="table" class="shiny-html-output"></div>
  
  <p>
    <label>Number of Replication:</label><br /> 
    <select name="n">
      <option value="500">500</option>
      <option value="1000">1000</option>
      <option value="2000">2000</option>
    </select> <br /> 
  </p>
  
   
   <div id="plot" class="shiny-plot-output" 
     style="width: 100%; height: 400px"></div>
     
 <p>

   <div />
   <form class="well">
   The mean number of the estimated median of miles driven in 2002 from bootstrap is
   <div id = "text1" class="shiny-text-output"></div><br />
   The estimated variance of bootstrap median is
   <div id = "text2" class="shiny-text-output"></div><br />
   The 95% confidence interval of bootstrap is
   <div id = "CItable" class = "shiny-html-output"></div>
   <form/>
  </p>
       
   
</body>
</html>